# patterns of deobfuscating function
PATTERNS = {
    "push_reg": {
        "name": "push_reg",
        "func_pattern": "./core/patterns/push_reg_func.grapp",
        "call_pattern": "./core/patterns/push_reg_call.grapp"
    },
    "detour_call": {
        "name": "detour_call",
        "func_pattern": "./core/patterns/detour_call_func.grapp",
        "call_pattern": "./core/patterns/detour_call_call.grapp"
    },
    "detour_jmp": {
        "name": "detour_jmp",
        "func_pattern": "./core/patterns/detour_jmp_func.grapp",
        "call_pattern": "./core/patterns/detour_jmp_call.grapp"
    }
}

# find the entrypoint of function
EP_PATTERN = """
digraph ep_func{
    ep [label="ep", cond="nfathers >= 2 and FILL_ADDR_COND", getid="ep"]
}
"""

# get XREFs to a given function
XREFS_PATTERN = """
digraph xrefs{
    call [label="call", cond="opcode is call", getid="call"]
    entrypoint [label="entrypoint", cond="address == FILL_ADDR"]
    call -> entrypoint [childnumber=2]
}
"""