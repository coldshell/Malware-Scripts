import idc

hides = []
in_junk = 0
curr_pos = 0
junk_len = 0

for seg_ea in idautils.Segments():
    for head in idautils.Heads(seg_ea, idc.SegEnd(seg_ea)):
        if idc.isCode(idc.GetFlags(head)):
            mnem = idc.GetMnem(head)
            end_junk = False
            if mnem == "nop":
                junk_len += 1
                if in_junk == 0:
                    curr_pos = head
                    in_junk = 1
            else:
                end_junk = True

            if end_junk:
                if in_junk == 1:
                    in_junk = 0
                    if junk_len > 1:
                        hides.append([curr_pos, junk_len])
                    curr_pos = 0
                    junk_len = 0
for h in hides:
    if h[1] > 1:
        idc.DelHiddenArea(h[0])
        idc.HideArea(h[0], h[0] + h[1], "nop instructions", "header", "footer", 0xFFB2EE)
